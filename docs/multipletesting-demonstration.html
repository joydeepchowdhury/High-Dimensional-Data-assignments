<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.5 Numerical demonstration | Assignments: Inference for High Dimensional Data</title>
  <meta name="description" content="Assignment problems for the course Inference for High Dimensional Data in M.Stat 2nd year, 2019-2020, at Indian Statistical Institute, Kolkata." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2.5 Numerical demonstration | Assignments: Inference for High Dimensional Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Assignment problems for the course Inference for High Dimensional Data in M.Stat 2nd year, 2019-2020, at Indian Statistical Institute, Kolkata." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.5 Numerical demonstration | Assignments: Inference for High Dimensional Data" />
  
  <meta name="twitter:description" content="Assignment problems for the course Inference for High Dimensional Data in M.Stat 2nd year, 2019-2020, at Indian Statistical Institute, Kolkata." />
  

<meta name="author" content="Joydeep Chowdhury" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multipletesting-summary.html"/>
<link rel="next" href="assignments.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Assignments: Inference for High Dimensional Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="regularizations.html"><a href="regularizations.html"><i class="fa fa-check"></i><b>1</b> Regularized regression</a>
<ul>
<li class="chapter" data-level="1.1" data-path="regularizations-description.html"><a href="regularizations-description.html"><i class="fa fa-check"></i><b>1.1</b> Lasso and other regularizations</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="regularizations-description.html"><a href="regularizations-description.html#lasso-description"><i class="fa fa-check"></i><b>1.1.1</b> Lasso</a></li>
<li class="chapter" data-level="1.1.2" data-path="regularizations-description.html"><a href="regularizations-description.html#ridge-description"><i class="fa fa-check"></i><b>1.1.2</b> Ridge regression</a></li>
<li class="chapter" data-level="1.1.3" data-path="regularizations-description.html"><a href="regularizations-description.html#elasticnet-description"><i class="fa fa-check"></i><b>1.1.3</b> Elastic net</a></li>
<li class="chapter" data-level="1.1.4" data-path="regularizations-description.html"><a href="regularizations-description.html#adaptivelasso-description"><i class="fa fa-check"></i><b>1.1.4</b> Adaptive lasso</a></li>
<li class="chapter" data-level="1.1.5" data-path="regularizations-description.html"><a href="regularizations-description.html#grouplasso-description"><i class="fa fa-check"></i><b>1.1.5</b> Group lasso</a></li>
<li class="chapter" data-level="1.1.6" data-path="regularizations-description.html"><a href="regularizations-description.html#fusedlasso-description"><i class="fa fa-check"></i><b>1.1.6</b> Fused lasso</a></li>
<li class="chapter" data-level="1.1.7" data-path="regularizations-description.html"><a href="regularizations-description.html#otherregularizations-description"><i class="fa fa-check"></i><b>1.1.7</b> Other regularizations</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html"><i class="fa fa-check"></i><b>1.2</b> Numerical demonstration</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html#lasso-computation"><i class="fa fa-check"></i><b>1.2.1</b> Lasso computation</a></li>
<li class="chapter" data-level="1.2.2" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html#ridge-computation"><i class="fa fa-check"></i><b>1.2.2</b> Ridge regression computation</a></li>
<li class="chapter" data-level="1.2.3" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html#elasticnet-computation"><i class="fa fa-check"></i><b>1.2.3</b> Elastic net computation</a></li>
<li class="chapter" data-level="1.2.4" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html#adaptivelasso-computation"><i class="fa fa-check"></i><b>1.2.4</b> Adaptive lasso computation</a></li>
<li class="chapter" data-level="1.2.5" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html#grouplasso-computation"><i class="fa fa-check"></i><b>1.2.5</b> Group lasso computation</a></li>
<li class="chapter" data-level="1.2.6" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html#fusedlasso-computation"><i class="fa fa-check"></i><b>1.2.6</b> Fused lasso computation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="multipletesting.html"><a href="multipletesting.html"><i class="fa fa-check"></i><b>2</b> Multiple testing</a>
<ul>
<li class="chapter" data-level="2.1" data-path="FWER.html"><a href="FWER.html"><i class="fa fa-check"></i><b>2.1</b> Controlling the familywise error rate</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="FWER.html"><a href="FWER.html#bonferroni"><i class="fa fa-check"></i><b>2.1.1</b> Bonferroni correction</a></li>
<li class="chapter" data-level="2.1.2" data-path="FWER.html"><a href="FWER.html#holm"><i class="fa fa-check"></i><b>2.1.2</b> Holm’s method</a></li>
<li class="chapter" data-level="2.1.3" data-path="FWER.html"><a href="FWER.html#hochberg"><i class="fa fa-check"></i><b>2.1.3</b> Hochberg’s method</a></li>
<li class="chapter" data-level="2.1.4" data-path="FWER.html"><a href="FWER.html#hommel"><i class="fa fa-check"></i><b>2.1.4</b> Hommel’s method</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="FDR.html"><a href="FDR.html"><i class="fa fa-check"></i><b>2.2</b> False discovery rate and its control</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="FDR.html"><a href="FDR.html#BH"><i class="fa fa-check"></i><b>2.2.1</b> Benjamini-Hochberg method</a></li>
<li class="chapter" data-level="2.2.2" data-path="FDR.html"><a href="FDR.html#BY"><i class="fa fa-check"></i><b>2.2.2</b> Benjamini–Yekutieli method</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="adjusted-pvalues.html"><a href="adjusted-pvalues.html"><i class="fa fa-check"></i><b>2.3</b> Adjusted p-values</a></li>
<li class="chapter" data-level="2.4" data-path="multipletesting-summary.html"><a href="multipletesting-summary.html"><i class="fa fa-check"></i><b>2.4</b> Summary</a></li>
<li class="chapter" data-level="2.5" data-path="multipletesting-demonstration.html"><a href="multipletesting-demonstration.html"><i class="fa fa-check"></i><b>2.5</b> Numerical demonstration</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="assignments.html"><a href="assignments.html"><i class="fa fa-check"></i><b>3</b> Assignments</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Assignments: Inference for High Dimensional Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multipletesting-demonstration" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Numerical demonstration</h2>
<p>All the methods for adjusted p-value computation described in <a href="adjusted-pvalues.html#adjusted-pvalues">2.3</a> are implemented in the function <code>p.adjust</code> available in the R package <strong>stats</strong> (included with base R distribution). Below, the use of this function is demonstrated.</p>
<p>Consider a simple case where we have 10 hypotheses each having a p-value 0.04. What will be the adjusted p-values for the various methods described in sections <a href="FWER.html#FWER">2.1</a> and <a href="FDR.html#FDR">2.2</a>? Their computation is presented below.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="multipletesting-demonstration.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector of p-values with length 10 and each element being 0.04</span></span>
<span id="cb83-2"><a href="multipletesting-demonstration.html#cb83-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">rep</span>(<span class="fl">0.04</span>, <span class="dv">10</span>)</span>
<span id="cb83-3"><a href="multipletesting-demonstration.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Actual p-values:</span><span class="sc">\n</span><span class="st">&#39;</span>, <span class="fu">paste</span>(p, <span class="at">collapse =</span> <span class="st">&#39; &#39;</span>)))</span>
<span id="cb83-4"><a href="multipletesting-demonstration.html#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="multipletesting-demonstration.html#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonferroni correction</span></span>
<span id="cb83-6"><a href="multipletesting-demonstration.html#cb83-6" aria-hidden="true" tabindex="-1"></a>p_bonferroni <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb83-7"><a href="multipletesting-demonstration.html#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Adjusted p-values for the&#39;</span>,</span>
<span id="cb83-8"><a href="multipletesting-demonstration.html#cb83-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Bonferroni correction:</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb83-9"><a href="multipletesting-demonstration.html#cb83-9" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">paste</span>(p_bonferroni, <span class="at">collapse =</span> <span class="st">&#39; &#39;</span>)))</span>
<span id="cb83-10"><a href="multipletesting-demonstration.html#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="multipletesting-demonstration.html#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Holm&#39;s method</span></span>
<span id="cb83-12"><a href="multipletesting-demonstration.html#cb83-12" aria-hidden="true" tabindex="-1"></a>p_holm <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;holm&#39;</span>)</span>
<span id="cb83-13"><a href="multipletesting-demonstration.html#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Adjusted p-values for the&#39;</span>,</span>
<span id="cb83-14"><a href="multipletesting-demonstration.html#cb83-14" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Holm</span><span class="sc">\&#39;</span><span class="st">s method:</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb83-15"><a href="multipletesting-demonstration.html#cb83-15" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">paste</span>(p_holm, <span class="at">collapse =</span> <span class="st">&#39; &#39;</span>)))</span>
<span id="cb83-16"><a href="multipletesting-demonstration.html#cb83-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-17"><a href="multipletesting-demonstration.html#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Hochberg&#39;s method</span></span>
<span id="cb83-18"><a href="multipletesting-demonstration.html#cb83-18" aria-hidden="true" tabindex="-1"></a>p_hochberg <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;hochberg&#39;</span>)</span>
<span id="cb83-19"><a href="multipletesting-demonstration.html#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Adjusted p-values for the&#39;</span>,</span>
<span id="cb83-20"><a href="multipletesting-demonstration.html#cb83-20" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Hochberg</span><span class="sc">\&#39;</span><span class="st">s method:</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb83-21"><a href="multipletesting-demonstration.html#cb83-21" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">paste</span>(p_hochberg, <span class="at">collapse =</span> <span class="st">&#39; &#39;</span>)))</span>
<span id="cb83-22"><a href="multipletesting-demonstration.html#cb83-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-23"><a href="multipletesting-demonstration.html#cb83-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Hommel&#39;s method</span></span>
<span id="cb83-24"><a href="multipletesting-demonstration.html#cb83-24" aria-hidden="true" tabindex="-1"></a>p_hommel <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;hommel&#39;</span>)</span>
<span id="cb83-25"><a href="multipletesting-demonstration.html#cb83-25" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Adjusted p-values for the&#39;</span>,</span>
<span id="cb83-26"><a href="multipletesting-demonstration.html#cb83-26" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Hommel</span><span class="sc">\&#39;</span><span class="st">s method:</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb83-27"><a href="multipletesting-demonstration.html#cb83-27" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">paste</span>(p_hommel, <span class="at">collapse =</span> <span class="st">&#39; &#39;</span>)))</span>
<span id="cb83-28"><a href="multipletesting-demonstration.html#cb83-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-29"><a href="multipletesting-demonstration.html#cb83-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Benjamini-Hochberg method</span></span>
<span id="cb83-30"><a href="multipletesting-demonstration.html#cb83-30" aria-hidden="true" tabindex="-1"></a>p_BH <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;BH&#39;</span>)</span>
<span id="cb83-31"><a href="multipletesting-demonstration.html#cb83-31" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Adjusted p-values for the&#39;</span>,</span>
<span id="cb83-32"><a href="multipletesting-demonstration.html#cb83-32" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Benjamini-Hochberg method:</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb83-33"><a href="multipletesting-demonstration.html#cb83-33" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">paste</span>(p_BH, <span class="at">collapse =</span> <span class="st">&#39; &#39;</span>)))</span>
<span id="cb83-34"><a href="multipletesting-demonstration.html#cb83-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-35"><a href="multipletesting-demonstration.html#cb83-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Benjamini–Yekutieli method</span></span>
<span id="cb83-36"><a href="multipletesting-demonstration.html#cb83-36" aria-hidden="true" tabindex="-1"></a>p_BY <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;BY&#39;</span>)</span>
<span id="cb83-37"><a href="multipletesting-demonstration.html#cb83-37" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Adjusted p-values for the&#39;</span>,</span>
<span id="cb83-38"><a href="multipletesting-demonstration.html#cb83-38" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Benjamini–Yekutieli method:</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb83-39"><a href="multipletesting-demonstration.html#cb83-39" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">paste</span>(<span class="fu">round</span>(p_BY, <span class="dv">3</span>), <span class="at">collapse =</span> <span class="st">&#39; &#39;</span>)))</span></code></pre></div>
<pre><code>## Actual p-values:
##  0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04
## Adjusted p-values for the Bonferroni correction:
##  0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4
## Adjusted p-values for the Holm&#39;s method:
##  0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4
## Adjusted p-values for the Hochberg&#39;s method:
##  0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04
## Adjusted p-values for the Hommel&#39;s method:
##  0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04
## Adjusted p-values for the Benjamini-Hochberg method:
##  0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04
## Adjusted p-values for the Benjamini–Yekutieli method:
##  0.117 0.117 0.117 0.117 0.117 0.117 0.117 0.117 0.117 0.117</code></pre>
<p>From the output above, the difference between the adjusted p-values of the Holm’s method and the Hochberg’s method is noticeable. It corroborates our earlier assertion in subsection <a href="FWER.html#hochberg">2.1.3</a> that the Hochberg’s method is uniformly more powerful than the Holm’s method, as every adjusted p-value for the Hochberg’s method is smaller than the corresponding adjusted p-value for the Holm’s method. However, though the Holm’s method is uniformly more powerfull than the Bonferroni correction and the Hommel method is more powerful than the Hochberg’s method, this toy example cannot confirm them, as all the corresponding adjusted p-values are identical. If we conduct simultaneous testing at level 0.05, the Bonferroni correction, the Holm’s method and the Benjamini–Yekutieli method fail to reject any hothesis, whereas the Hochberg’s method, the Hommel’s method and the Benjamini-Hochberg method reject all the hypotheses.</p>
<p>Next, we consider a real dataset: the <code>golub</code> dataset from the R package <strong>multtest</strong> available in <a href="https://www.bioconductor.org/packages/release/bioc/html/multtest.html">Bioconductor</a>. This dataset contains the expression levels of 3051 genes based on 38 tumor mRNA samples from a leukemia microarray study presented in <span class="citation"><a href="#ref-golub1999molecular" role="doc-biblioref">Golub et al.</a> (<a href="#ref-golub1999molecular" role="doc-biblioref">1999</a>)</span>. Among the 38 tumor samples, 27 are acute lymphoblastic leukemia (ALL) cases and 11 are acute myeloid leukemia (AML) cases. The <code>golub</code> datatset is a matrix with 3051 rows and 38 columns. Each row corresponds to a gene, the first 27 columns correspond to ALL cases and the last 11 columns correspond to AML cases. We are interested in investigating the presence of statistically significant differences in expression levels for the 3051 genes among the two types of cancers.</p>
<p>First we need to install the ‘multtest’ package from Bioconductor, which can be done using the function ‘install’ from the package ‘BiocManager.’ The code in the next line would do this.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="multipletesting-demonstration.html#cb85-1" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&#39;multtest&#39;</span>)</span></code></pre></div>
<p>Now, the computation procedure is demonstrated below.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="multipletesting-demonstration.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the data from the package &#39;multtest&#39;</span></span>
<span id="cb86-2"><a href="multipletesting-demonstration.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;golub&#39;</span>, <span class="at">package =</span> <span class="st">&#39;multtest&#39;</span>)</span>
<span id="cb86-3"><a href="multipletesting-demonstration.html#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="multipletesting-demonstration.html#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Storing the data corresponding to ALL cases in the</span></span>
<span id="cb86-5"><a href="multipletesting-demonstration.html#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co"># variable golub_ALL</span></span>
<span id="cb86-6"><a href="multipletesting-demonstration.html#cb86-6" aria-hidden="true" tabindex="-1"></a>golub_ALL <span class="ot">=</span> golub[,<span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>]</span>
<span id="cb86-7"><a href="multipletesting-demonstration.html#cb86-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-8"><a href="multipletesting-demonstration.html#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Storing the data corresponding to AML cases in the</span></span>
<span id="cb86-9"><a href="multipletesting-demonstration.html#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="co"># variable golub_AML</span></span>
<span id="cb86-10"><a href="multipletesting-demonstration.html#cb86-10" aria-hidden="true" tabindex="-1"></a>golub_AML <span class="ot">=</span> golub[,<span class="dv">28</span><span class="sc">:</span><span class="dv">38</span>]</span>
<span id="cb86-11"><a href="multipletesting-demonstration.html#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="multipletesting-demonstration.html#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="co"># m is the number of tests, which is equal to the</span></span>
<span id="cb86-13"><a href="multipletesting-demonstration.html#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="co"># number of genes</span></span>
<span id="cb86-14"><a href="multipletesting-demonstration.html#cb86-14" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">nrow</span>(golub)</span>
<span id="cb86-15"><a href="multipletesting-demonstration.html#cb86-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-16"><a href="multipletesting-demonstration.html#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing the p-values using a two-sample t test</span></span>
<span id="cb86-17"><a href="multipletesting-demonstration.html#cb86-17" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb86-18"><a href="multipletesting-demonstration.html#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb86-19"><a href="multipletesting-demonstration.html#cb86-19" aria-hidden="true" tabindex="-1"></a>  p[i] <span class="ot">=</span> <span class="fu">t.test</span>(golub_ALL[i,], golub_AML[i,],</span>
<span id="cb86-20"><a href="multipletesting-demonstration.html#cb86-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative =</span> <span class="st">&#39;two.sided&#39;</span>)<span class="sc">$</span>p.value</span>
<span id="cb86-21"><a href="multipletesting-demonstration.html#cb86-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-22"><a href="multipletesting-demonstration.html#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the adjusted p-values</span></span>
<span id="cb86-23"><a href="multipletesting-demonstration.html#cb86-23" aria-hidden="true" tabindex="-1"></a>p_bonferroni <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb86-24"><a href="multipletesting-demonstration.html#cb86-24" aria-hidden="true" tabindex="-1"></a>p_holm <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;holm&#39;</span>)</span>
<span id="cb86-25"><a href="multipletesting-demonstration.html#cb86-25" aria-hidden="true" tabindex="-1"></a>p_hochberg <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;hochberg&#39;</span>)</span>
<span id="cb86-26"><a href="multipletesting-demonstration.html#cb86-26" aria-hidden="true" tabindex="-1"></a>p_hommel <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;hommel&#39;</span>)</span>
<span id="cb86-27"><a href="multipletesting-demonstration.html#cb86-27" aria-hidden="true" tabindex="-1"></a>p_BH <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;BH&#39;</span>)</span>
<span id="cb86-28"><a href="multipletesting-demonstration.html#cb86-28" aria-hidden="true" tabindex="-1"></a>p_BY <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;BY&#39;</span>)</span>
<span id="cb86-29"><a href="multipletesting-demonstration.html#cb86-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-30"><a href="multipletesting-demonstration.html#cb86-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the number of rejections based on level 0.05.</span></span>
<span id="cb86-31"><a href="multipletesting-demonstration.html#cb86-31" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb86-32"><a href="multipletesting-demonstration.html#cb86-32" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Number of rejections based on&#39;</span>,</span>
<span id="cb86-33"><a href="multipletesting-demonstration.html#cb86-33" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;unadjusted p-values:&#39;</span>, <span class="fu">sum</span>(p <span class="sc">&lt;=</span> alpha)))</span>
<span id="cb86-34"><a href="multipletesting-demonstration.html#cb86-34" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Number of rejections based on&#39;</span>,</span>
<span id="cb86-35"><a href="multipletesting-demonstration.html#cb86-35" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Bonferroni correction:&#39;</span>,</span>
<span id="cb86-36"><a href="multipletesting-demonstration.html#cb86-36" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>(p_bonferroni <span class="sc">&lt;=</span> alpha)))</span>
<span id="cb86-37"><a href="multipletesting-demonstration.html#cb86-37" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Number of rejections based on&#39;</span>,</span>
<span id="cb86-38"><a href="multipletesting-demonstration.html#cb86-38" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Holm</span><span class="sc">\&#39;</span><span class="st">s method:&#39;</span>,</span>
<span id="cb86-39"><a href="multipletesting-demonstration.html#cb86-39" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>(p_holm <span class="sc">&lt;=</span> alpha)))</span>
<span id="cb86-40"><a href="multipletesting-demonstration.html#cb86-40" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Number of rejections based on&#39;</span>,</span>
<span id="cb86-41"><a href="multipletesting-demonstration.html#cb86-41" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Hochberg</span><span class="sc">\&#39;</span><span class="st">s method:&#39;</span>,</span>
<span id="cb86-42"><a href="multipletesting-demonstration.html#cb86-42" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>(p_hochberg <span class="sc">&lt;=</span> alpha)))</span>
<span id="cb86-43"><a href="multipletesting-demonstration.html#cb86-43" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Number of rejections based on&#39;</span>,</span>
<span id="cb86-44"><a href="multipletesting-demonstration.html#cb86-44" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Hommel</span><span class="sc">\&#39;</span><span class="st">s method:&#39;</span>,</span>
<span id="cb86-45"><a href="multipletesting-demonstration.html#cb86-45" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>(p_hommel <span class="sc">&lt;=</span> alpha)))</span>
<span id="cb86-46"><a href="multipletesting-demonstration.html#cb86-46" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Number of rejections based on&#39;</span>,</span>
<span id="cb86-47"><a href="multipletesting-demonstration.html#cb86-47" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Benjamini-Hochberg method:&#39;</span>,</span>
<span id="cb86-48"><a href="multipletesting-demonstration.html#cb86-48" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>(p_BH <span class="sc">&lt;=</span> alpha)))</span>
<span id="cb86-49"><a href="multipletesting-demonstration.html#cb86-49" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&#39;Number of rejections based on&#39;</span>,</span>
<span id="cb86-50"><a href="multipletesting-demonstration.html#cb86-50" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Benjamini–Yekutieli method:&#39;</span>,</span>
<span id="cb86-51"><a href="multipletesting-demonstration.html#cb86-51" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>(p_BY <span class="sc">&lt;=</span> alpha)))</span></code></pre></div>
<pre><code>## Number of rejections based on unadjusted p-values: 1078
## Number of rejections based on Bonferroni correction: 103
## Number of rejections based on Holm&#39;s method: 103
## Number of rejections based on Hochberg&#39;s method: 103
## Number of rejections based on Hommel&#39;s method: 108
## Number of rejections based on Benjamini-Hochberg method: 695
## Number of rejections based on Benjamini–Yekutieli method: 293</code></pre>
<p>We note that the Bonferroni’s correction is the most conservative procedure, as expected. However, here the Holm’s method and the Hochberg’s method are also as much conservative as the Bonferroni’s correction. The FDR controlling procedures are relatively less conservative compared to the FWER controlling procedures, again as expected.</p>

</div>
<!-- </div> -->
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-golub1999molecular" class="csl-entry">
Golub, Todd R, Donna K Slonim, Pablo Tamayo, Christine Huard, Michelle Gaasenbeek, Jill P Mesirov, Hilary Coller, et al. 1999. <span>“Molecular Classification of Cancer: Class Discovery and Class Prediction by Gene Expression Monitoring.”</span> <em>Science</em> 286 (5439): 531–37.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multipletesting-summary.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="assignments.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["High-Dimensional-Data-assignments.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
